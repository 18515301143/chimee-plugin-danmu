!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.chimeePluginDanmu=e()}(this,function(){"use strict";function t(t){return t&&t.__esModule?t.default:t}function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}function n(t){return void 0===t||null===t}function r(t){return Array.isArray(t)}function i(t){return"function"==typeof t}function o(t){return Object(t)===t&&"[object Object]"===String(t)&&!i(t)&&!r(t)}function u(t){return"number"==typeof t}function a(t){return"string"==typeof t||t instanceof String}function c(t){return"boolean"==typeof t}function s(t){return n(t)||c(t)||a(t)||u(t)}function f(t,e){if(!a(t))throw new TypeError("Log's method only acccept string as argument");return a(e)?"["+(t=Mn.FORCE_GLOBAL_TAG?Mn.GLOBAL_TAG:t||Mn.GLOBAL_TAG)+"] > "+e:"["+Mn.GLOBAL_TAG+"] > "+t}function l(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e.length<2)throw new Error("deepAssign accept two and more argument");for(var r=e.length-1;r>-1;r--)if(s(e[r]))throw new TypeError("deepAssign only accept non primitive type");var i=e.shift();return e.forEach(function(t){return Zn(t,i)}),i}function h(t,e){return t.bind?t.bind(e):t.apply?function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.apply(e,r)}:function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.call.apply(t,[e].concat(Qn(r)))}}function d(t,e){var n=t.__evt_id;n||(Object.defineProperty(t,"__evt_id",{writable:!0,enumerable:!1,configurable:!0}),n=t.__evt_id=++Zr.count);var r=n+"_"+e,i=Zr[r];return i||(i=Zr[r]=[]),i}function p(t,e,n){var r=Qr(null);r.type=e,r.target=t,n&&Vr(r,o(n)?n:{data:n}),d(t,e).forEach(function(e){(e[1]||e[0]).apply(t,[r])})}function v(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];i(r)&&!o&&(o=r,r=void 0);var u=[n,void 0,r];r&&!o&&(o=function(){y(t,e,n,r);for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];n.apply(t,o)}),o&&(u[1]=o),d(t,e).push(u)}function y(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=d(t,e);if(n||r){var o=-1,u=void 0;return i.find(function(t,e){if((!n||t[0]===n)&&(!r||t[2]))return o=e,u=t[1],!0}),-1!==o&&i.splice(o,1),u}i.length=0}function m(t,e){var n=t.__evt_id;n||(Object.defineProperty(t,"__evt_id",{writable:!0,enumerable:!1,configurable:!0}),n=t.__evt_id=++ti.count);var r=n+"_"+e,i=ti[r];return i||(i=ti[r]=[]),i}function g(t,e,n){var r=Qr(null);r.type=e,r.target=t,n&&Vr(r,o(n)?n:{data:n}),m(t,e).forEach(function(e){(e[1]||e[0]).apply(t,[r])})}function w(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];i(r)&&!o&&(o=r,r=void 0);var u=[n,void 0,r];r&&!o&&(o=function(){_(t,e,n,r);for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];n.apply(t,o)}),o&&(u[1]=o),m(t,e).push(u)}function _(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=m(t,e);if(n||r){var o=-1,u=void 0;return i.find(function(t,e){if((!n||t[0]===n)&&(!r||t[2]))return o=e,u=t[1],!0}),-1!==o&&i.splice(o,1),u}i.length=0}function b(t){return Xn(t)}function O(t,e){return t.getAttribute(e)}function E(t,e,n){void 0===n?t.removeAttribute(e):t.setAttribute(e,n)}function x(t,e){if(e&&(e=e.trim())){var n=e.split(/\s+/);if(t.classList)n.forEach(function(e){return t.classList.add(e)});else{var r=" "+(t.className||"")+" ";n.forEach(function(t){-1===r.indexOf(" "+t+" ")&&(r+=" "+t)}),t.className=r.trim()}}}function k(t,e){if(e&&(e=e.trim())){var n=e.split(/\s+/);if(t.classList)n.forEach(function(e){return t.classList.remove(e)});else{var r=" "+t.className+" ";n.forEach(function(t){for(var e=" "+t+" ";-1!==r.indexOf(e);)r=r.replace(e," ")}),t.className=r.trim()}}}function A(t,e){return new RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t.className)}function j(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(r){var o=_(t,e+"_once",n);o&&(n=o)}t.removeEventListener(e,n,i)}function S(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(r){var o=n;w(t,e+"_once",o,n=function(){for(var u=arguments.length,a=Array(u),c=0;c<u;c++)a[c]=arguments[c];o.apply(this,a),j(t,e,n,r,i)})}t.addEventListener(e,n,i)}function P(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(n){var i=C(n.srcElement,t,!0),o=N(e,t,!0).find(function(t){return i.find(function(e){return t===e})});o&&r.apply(o,arguments)};w(t,n+"_delegate_"+e,r,o),t.addEventListener(n,o,i)}function M(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=_(t,n+"_delegate_"+e,r);o&&t.removeEventListener(n,o,i)}function T(t,e){return(t.currentStyle||document.defaultView.getComputedStyle(t,null))[e]||t.style[e]}function L(t,e,n){if(o(e))for(var r in e)L(t,r,e[r]);else t.style[e]=n}function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=arguments[2],r=e.querySelectorAll(t);return n?Xn(r):r}function F(t){t.parentNode.removeChild(t)}function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],r=arguments[3],i=[];for(n&&i.push(t);t&&t.parentNode!==e;)(t=t.parentNode)&&i.push(t);return r&&i.push(e),i}function z(t,e){return t.constructor===ii?t:new ii(t,e)}function R(t){if(!t||!t.hasOwnProperty)return!1;for(var e=["value","initializer","get","set"],n=0,r=e.length;n<r;n++)if(t.hasOwnProperty(e[n]))return!0;return!1}function D(t){return!!t&&t.hasOwnProperty("value")&&c(t.configurable)&&c(t.enumerable)&&c(t.writable)}function B(t){return function(e){return lt(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e}),e}}function I(t,e){if(void 0===Gi)throw new Error("Using @autobind on "+e.name+"() requires WeakMap support due to its use of super."+e.name+"()");to||(to=new Gi),!1===to.has(t)&&to.set(t,new Gi);var n=to.get(t);return!1===n.has(e)&&n.set(e,h(e,t)),n.get(e)}function H(t,e,n){if(1===arguments.length)return Zi()(t);if(!R(n))throw new Error("@autobind must used on descriptor, are you using it on undefined property?");var r=n.value,o=n.configurable;if(!i(r))throw new TypeError("@autobind can only be used on functions, not: "+r+")");var u=t.constructor;return{configurable:o,enumerable:!1,get:function(){var n=this,i=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.call.apply(r,[n].concat(Qn(e)))};return this===t?r:this.constructor!==u&&Ai(this).constructor===u?r:this.constructor!==u&&e in this.constructor.prototype?I(this,r):(lt(this,e,{configurable:!0,writable:!0,enumerable:!1,value:i}),i)},set:B(e)}}var W=t(e(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),G=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),q=e(function(t){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)}),$=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},U=function(t,e,n){if($(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},K=function(t){return"object"==typeof t?null!==t:"function"==typeof t},J=function(t){if(!K(t))throw TypeError(t+" is not an object!");return t},V=function(t){try{return!!t()}catch(t){return!0}},Y=!V(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),X=G.document,Q=K(X)&&K(X.createElement),Z=function(t){return Q?X.createElement(t):{}},tt=!Y&&!V(function(){return 7!=Object.defineProperty(Z("div"),"a",{get:function(){return 7}}).a}),et=function(t,e){if(!K(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!K(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!K(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!K(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},nt=Object.defineProperty,rt={f:Y?Object.defineProperty:function(t,e,n){if(J(t),e=et(e,!0),J(n),tt)try{return nt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},it=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ot=Y?function(t,e,n){return rt.f(t,e,it(1,n))}:function(t,e,n){return t[e]=n,t},ut=function(t,e,n){var r,i,o,u=t&ut.F,a=t&ut.G,c=t&ut.S,s=t&ut.P,f=t&ut.B,l=t&ut.W,h=a?q:q[e]||(q[e]={}),d=h.prototype,p=a?G:c?G[e]:(G[e]||{}).prototype;a&&(n=e);for(r in n)(i=!u&&p&&void 0!==p[r])&&r in h||(o=i?p[r]:n[r],h[r]=a&&"function"!=typeof p[r]?n[r]:f&&i?U(o,G):l&&p[r]==o?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(o):s&&"function"==typeof o?U(Function.call,o):o,s&&((h.virtual||(h.virtual={}))[r]=o,t&ut.R&&d&&!d[r]&&ot(d,r,o)))};ut.F=1,ut.G=2,ut.S=4,ut.P=8,ut.B=16,ut.W=32,ut.U=64,ut.R=128;var at=ut;at(at.S+at.F*!Y,"Object",{defineProperty:rt.f});var ct=q.Object,st=function(t,e,n){return ct.defineProperty(t,e,n)},ft=e(function(t){t.exports={default:st,__esModule:!0}}),lt=t(ft),ht=t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(ft);e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(t,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()})),dt=Math.ceil,pt=Math.floor,vt=function(t){return isNaN(t=+t)?0:(t>0?pt:dt)(t)},yt=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},mt=ot,gt={}.hasOwnProperty,wt=function(t,e){return gt.call(t,e)},_t={},bt={}.toString,Ot=function(t){return bt.call(t).slice(8,-1)},Et=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Ot(t)?t.split(""):Object(t)},xt=function(t){return Et(yt(t))},kt=Math.min,At=function(t){return t>0?kt(vt(t),9007199254740991):0},jt=Math.max,St=Math.min,Pt=function(t,e){return(t=vt(t))<0?jt(t+e,0):St(t,e)},Mt=G["__core-js_shared__"]||(G["__core-js_shared__"]={}),Tt=function(t){return Mt[t]||(Mt[t]={})},Lt=0,Nt=Math.random(),Ft=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++Lt+Nt).toString(36))},Ct=Tt("keys"),zt=function(t){return Ct[t]||(Ct[t]=Ft(t))},Rt=function(t){return function(e,n,r){var i,o=xt(e),u=At(o.length),a=Pt(r,u);if(t&&n!=n){for(;u>a;)if((i=o[a++])!=i)return!0}else for(;u>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}}(!1),Dt=zt("IE_PROTO"),Bt=function(t,e){var n,r=xt(t),i=0,o=[];for(n in r)n!=Dt&&wt(r,n)&&o.push(n);for(;e.length>i;)wt(r,n=e[i++])&&(~Rt(o,n)||o.push(n));return o},It="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Ht=Object.keys||function(t){return Bt(t,It)},Wt=Y?Object.defineProperties:function(t,e){J(t);for(var n,r=Ht(e),i=r.length,o=0;i>o;)rt.f(t,n=r[o++],e[n]);return t},Gt=G.document&&document.documentElement,qt=zt("IE_PROTO"),$t=function(){},Ut=function(){var t,e=Z("iframe"),n=It.length;for(e.style.display="none",Gt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Ut=t.F;n--;)delete Ut.prototype[It[n]];return Ut()},Kt=Object.create||function(t,e){var n;return null!==t?($t.prototype=J(t),n=new $t,$t.prototype=null,n[qt]=t):n=Ut(),void 0===e?n:Wt(n,e)},Jt=e(function(t){var e=Tt("wks"),n=G.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:Ft)("Symbol."+t))}).store=e}),Vt=rt.f,Yt=Jt("toStringTag"),Xt=function(t,e,n){t&&!wt(t=n?t:t.prototype,Yt)&&Vt(t,Yt,{configurable:!0,value:e})},Qt={};ot(Qt,Jt("iterator"),function(){return this});var Zt=function(t,e,n){t.prototype=Kt(Qt,{next:it(1,n)}),Xt(t,e+" Iterator")},te=function(t){return Object(yt(t))},ee=zt("IE_PROTO"),ne=Object.prototype,re=Object.getPrototypeOf||function(t){return t=te(t),wt(t,ee)?t[ee]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ne:null},ie=Jt("iterator"),oe=!([].keys&&"next"in[].keys()),ue=function(){return this},ae=function(t,e,n,r,i,o,u){Zt(n,e,r);var a,c,s,f=function(t){if(!oe&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},l=e+" Iterator",h="values"==i,d=!1,p=t.prototype,v=p[ie]||p["@@iterator"]||i&&p[i],y=v||f(i),m=i?h?f("entries"):y:void 0,g="Array"==e?p.entries||v:v;if(g&&(s=re(g.call(new t)))!==Object.prototype&&Xt(s,l,!0),h&&v&&"values"!==v.name&&(d=!0,y=function(){return v.call(this)}),u&&(oe||d||!p[ie])&&ot(p,ie,y),_t[e]=y,_t[l]=ue,i)if(a={values:h?y:f("values"),keys:o?y:f("keys"),entries:m},u)for(c in a)c in p||mt(p,c,a[c]);else at(at.P+at.F*(oe||d),e,a);return a},ce=function(t){return function(e,n){var r,i,o=String(yt(e)),u=vt(n),a=o.length;return u<0||u>=a?t?"":void 0:(r=o.charCodeAt(u))<55296||r>56319||u+1===a||(i=o.charCodeAt(u+1))<56320||i>57343?t?o.charAt(u):r:t?o.slice(u,u+2):i-56320+(r-55296<<10)+65536}}(!0);ae(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=ce(e,n),this._i+=t.length,{value:t,done:!1})});var se=function(){},fe=function(t,e){return{value:e,done:!!t}};ae(Array,"Array",function(t,e){this._t=xt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,fe(1)):"keys"==e?fe(0,n):"values"==e?fe(0,t[n]):fe(0,[n,t[n]])},"values");_t.Arguments=_t.Array,se(),se(),se();for(var le=Jt("toStringTag"),he=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],de=0;de<5;de++){var pe=he[de],ve=G[pe],ye=ve&&ve.prototype;ye&&!ye[le]&&ot(ye,le,pe),_t[pe]=_t.Array}var me={f:Jt},ge=me.f("iterator"),we=e(function(t){t.exports={default:ge,__esModule:!0}}),_e=e(function(t){var e=Ft("meta"),n=rt.f,r=0,i=Object.isExtensible||function(){return!0},o=!V(function(){return i(Object.preventExtensions({}))}),u=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},a=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!K(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!wt(t,e)){if(!i(t))return"F";if(!n)return"E";u(t)}return t[e].i},getWeak:function(t,n){if(!wt(t,e)){if(!i(t))return!0;if(!n)return!1;u(t)}return t[e].w},onFreeze:function(t){return o&&a.NEED&&i(t)&&!wt(t,e)&&u(t),t}}}),be=rt.f,Oe=function(t){var e=q.Symbol||(q.Symbol={});"_"==t.charAt(0)||t in e||be(e,t,{value:me.f(t)})},Ee=function(t,e){for(var n,r=xt(t),i=Ht(r),o=i.length,u=0;o>u;)if(r[n=i[u++]]===e)return n},xe={f:Object.getOwnPropertySymbols},ke={f:{}.propertyIsEnumerable},Ae=function(t){var e=Ht(t),n=xe.f;if(n)for(var r,i=n(t),o=ke.f,u=0;i.length>u;)o.call(t,r=i[u++])&&e.push(r);return e},je=Array.isArray||function(t){return"Array"==Ot(t)},Se=It.concat("length","prototype"),Pe={f:Object.getOwnPropertyNames||function(t){return Bt(t,Se)}},Me=Pe.f,Te={}.toString,Le="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ne=function(t){try{return Me(t)}catch(t){return Le.slice()}},Fe={f:function(t){return Le&&"[object Window]"==Te.call(t)?Ne(t):Me(xt(t))}},Ce=Object.getOwnPropertyDescriptor,ze={f:Y?Ce:function(t,e){if(t=xt(t),e=et(e,!0),tt)try{return Ce(t,e)}catch(t){}if(wt(t,e))return it(!ke.f.call(t,e),t[e])}},Re=_e.KEY,De=ze.f,Be=rt.f,Ie=Fe.f,He=G.Symbol,We=G.JSON,Ge=We&&We.stringify,qe=Jt("_hidden"),$e=Jt("toPrimitive"),Ue={}.propertyIsEnumerable,Ke=Tt("symbol-registry"),Je=Tt("symbols"),Ve=Tt("op-symbols"),Ye=Object.prototype,Xe="function"==typeof He,Qe=G.QObject,Ze=!Qe||!Qe.prototype||!Qe.prototype.findChild,tn=Y&&V(function(){return 7!=Kt(Be({},"a",{get:function(){return Be(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=De(Ye,e);r&&delete Ye[e],Be(t,e,n),r&&t!==Ye&&Be(Ye,e,r)}:Be,en=function(t){var e=Je[t]=Kt(He.prototype);return e._k=t,e},nn=Xe&&"symbol"==typeof He.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof He},rn=function(t,e,n){return t===Ye&&rn(Ve,e,n),J(t),e=et(e,!0),J(n),wt(Je,e)?(n.enumerable?(wt(t,qe)&&t[qe][e]&&(t[qe][e]=!1),n=Kt(n,{enumerable:it(0,!1)})):(wt(t,qe)||Be(t,qe,it(1,{})),t[qe][e]=!0),tn(t,e,n)):Be(t,e,n)},on=function(t,e){J(t);for(var n,r=Ae(e=xt(e)),i=0,o=r.length;o>i;)rn(t,n=r[i++],e[n]);return t},un=function(t){var e=Ue.call(this,t=et(t,!0));return!(this===Ye&&wt(Je,t)&&!wt(Ve,t))&&(!(e||!wt(this,t)||!wt(Je,t)||wt(this,qe)&&this[qe][t])||e)},an=function(t,e){if(t=xt(t),e=et(e,!0),t!==Ye||!wt(Je,e)||wt(Ve,e)){var n=De(t,e);return!n||!wt(Je,e)||wt(t,qe)&&t[qe][e]||(n.enumerable=!0),n}},cn=function(t){for(var e,n=Ie(xt(t)),r=[],i=0;n.length>i;)wt(Je,e=n[i++])||e==qe||e==Re||r.push(e);return r},sn=function(t){for(var e,n=t===Ye,r=Ie(n?Ve:xt(t)),i=[],o=0;r.length>o;)!wt(Je,e=r[o++])||n&&!wt(Ye,e)||i.push(Je[e]);return i};Xe||(mt((He=function(){if(this instanceof He)throw TypeError("Symbol is not a constructor!");var t=Ft(arguments.length>0?arguments[0]:void 0),e=function(n){this===Ye&&e.call(Ve,n),wt(this,qe)&&wt(this[qe],t)&&(this[qe][t]=!1),tn(this,t,it(1,n))};return Y&&Ze&&tn(Ye,t,{configurable:!0,set:e}),en(t)}).prototype,"toString",function(){return this._k}),ze.f=an,rt.f=rn,Pe.f=Fe.f=cn,ke.f=un,xe.f=sn,me.f=function(t){return en(Jt(t))}),at(at.G+at.W+at.F*!Xe,{Symbol:He});for(var fn="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ln=0;fn.length>ln;)Jt(fn[ln++]);for(var fn=Ht(Jt.store),ln=0;fn.length>ln;)Oe(fn[ln++]);at(at.S+at.F*!Xe,"Symbol",{for:function(t){return wt(Ke,t+="")?Ke[t]:Ke[t]=He(t)},keyFor:function(t){if(nn(t))return Ee(Ke,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){Ze=!0},useSimple:function(){Ze=!1}}),at(at.S+at.F*!Xe,"Object",{create:function(t,e){return void 0===e?Kt(t):on(Kt(t),e)},defineProperty:rn,defineProperties:on,getOwnPropertyDescriptor:an,getOwnPropertyNames:cn,getOwnPropertySymbols:sn}),We&&at(at.S+at.F*(!Xe||V(function(){var t=He();return"[null]"!=Ge([t])||"{}"!=Ge({a:t})||"{}"!=Ge(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!nn(t)){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);return"function"==typeof(e=r[1])&&(n=e),!n&&je(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!nn(e))return e}),r[1]=e,Ge.apply(We,r)}}}),He.prototype[$e]||ot(He.prototype,$e,He.prototype.valueOf),Xt(He,"Symbol"),Xt(Math,"Math",!0),Xt(G.JSON,"JSON",!0),Oe("asyncIterator"),Oe("observable");var hn=q.Symbol,dn=e(function(t){t.exports={default:hn,__esModule:!0}}),pn=t(e(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(we),i=n(dn),o="function"==typeof i.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};e.default="function"==typeof i.default&&"symbol"===o(r.default)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":o(t)}})),vn=function(t,e){var n=(q.Object||{})[t]||Object[t],r={};r[t]=e(n),at(at.S+at.F*V(function(){n(1)}),"Object",r)};vn("keys",function(){return function(t){return Ht(te(t))}});var yn=q.Object.keys,mn=(e(function(t){t.exports={default:yn,__esModule:!0}}),Math.floor);at(at.S,"Number",{isInteger:function(t){return!K(t)&&isFinite(t)&&mn(t)===t}});var gn=q.Number.isInteger,wn=(e(function(t){t.exports={default:gn,__esModule:!0}}),"\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"),_n="["+wn+"]",bn=RegExp("^"+_n+_n+"*"),On=RegExp(_n+_n+"*$"),En=function(t,e,n){var r={},i=V(function(){return!!wn[t]()||"​"!="​"[t]()}),o=r[t]=i?e(xn):wn[t];n&&(r[n]=o),at(at.P+at.F*i,"String",r)},xn=En.trim=function(t,e){return t=String(yt(t)),1&e&&(t=t.replace(bn,"")),2&e&&(t=t.replace(On,"")),t},kn=En,An=G.parseFloat,jn=kn.trim,Sn=1/An(wn+"-0")!=-1/0?function(t){var e=jn(String(t),3),n=An(e);return 0===n&&"-"==e.charAt(0)?-0:n}:An;at(at.S+at.F*(Number.parseFloat!=Sn),"Number",{parseFloat:Sn});var Pn=parseFloat,Mn=(e(function(t){t.exports={default:Pn,__esModule:!0}}),function(){function t(){W(this,t)}return ht(t,null,[{key:"error",value:function(e,n){t.ENABLE_ERROR&&(console.error||console.warn||console.log)(f(e,n))}},{key:"info",value:function(e,n){t.ENABLE_INFO&&(console.info||console.log)(f(e,n))}},{key:"warn",value:function(e,n){t.ENABLE_WARN&&(console.warn||console.log)(f(e,n))}},{key:"debug",value:function(e,n){t.ENABLE_DEBUG&&(console.debug||console.log)(f(e,n))}},{key:"verbose",value:function(e,n){t.ENABLE_VERBOSE&&console.log(f(e,n))}}]),t}());Mn.GLOBAL_TAG="chimee",Mn.FORCE_GLOBAL_TAG=!1,Mn.ENABLE_ERROR=!0,Mn.ENABLE_INFO=!0,Mn.ENABLE_WARN=!0,Mn.ENABLE_DEBUG=!0,Mn.ENABLE_VERBOSE=!0;var Tn=function(t,e,n,r){try{return r?e(J(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&J(i.call(t)),e}},Ln=Jt("iterator"),Nn=Array.prototype,Fn=function(t){return void 0!==t&&(_t.Array===t||Nn[Ln]===t)},Cn=function(t,e,n){e in t?rt.f(t,e,it(0,n)):t[e]=n},zn=Jt("toStringTag"),Rn="Arguments"==Ot(function(){return arguments}()),Dn=function(t,e){try{return t[e]}catch(t){}},Bn=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=Dn(e=Object(t),zn))?n:Rn?Ot(e):"Object"==(r=Ot(e))&&"function"==typeof e.callee?"Arguments":r},In=Jt("iterator"),Hn=q.getIteratorMethod=function(t){if(void 0!=t)return t[In]||t["@@iterator"]||_t[Bn(t)]},Wn=Jt("iterator"),Gn=!1;try{var qn=[7][Wn]();qn.return=function(){Gn=!0},Array.from(qn,function(){throw 2})}catch(t){}var $n=function(t,e){if(!e&&!Gn)return!1;var n=!1;try{var r=[7],i=r[Wn]();i.next=function(){return{done:n=!0}},r[Wn]=function(){return i},t(r)}catch(t){}return n};at(at.S+at.F*!$n(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,i,o=te(t),u="function"==typeof this?this:Array,a=arguments.length,c=a>1?arguments[1]:void 0,s=void 0!==c,f=0,l=Hn(o);if(s&&(c=U(c,a>2?arguments[2]:void 0,2)),void 0==l||u==Array&&Fn(l))for(n=new u(e=At(o.length));e>f;f++)Cn(n,f,s?c(o[f],f):o[f]);else for(i=l.call(o),n=new u;!(r=i.next()).done;f++)Cn(n,f,s?Tn(i,c,[r.value,f],!0):r.value);return n.length=f,n}});var Un,Kn,Jn,Vn=q.Array.from,Yn=e(function(t){t.exports={default:Vn,__esModule:!0}}),Xn=t(Yn),Qn=t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(Yn);e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,n.default)(t)}})),Zn=function(t){function e(n,i,u){if(r(n)||o(n)){i=i||(o(n)?{}:[]);for(var a in n)i[a]=e(n[a],i[a],a);return i}return t(n,i,u)}return e}(function(t){return t}),tr=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t},er=e(function(t){var e={},n={},r=t.exports=function(t,r,i,o,u){var a,c,s,f,l=u?function(){return t}:Hn(t),h=U(i,o,r?2:1),d=0;if("function"!=typeof l)throw TypeError(t+" is not iterable!");if(Fn(l)){for(a=At(t.length);a>d;d++)if((f=r?h(J(c=t[d])[0],c[1]):h(t[d]))===e||f===n)return f}else for(s=l.call(t);!(c=s.next()).done;)if((f=Tn(s,h,c.value,r))===e||f===n)return f};r.BREAK=e,r.RETURN=n}),nr=Jt("species"),rr=function(t,e){var n,r=J(t).constructor;return void 0===r||void 0==(n=J(r)[nr])?e:$(n)},ir=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},or=G.process,ur=G.setImmediate,ar=G.clearImmediate,cr=G.MessageChannel,sr=0,fr={},lr=function(){var t=+this;if(fr.hasOwnProperty(t)){var e=fr[t];delete fr[t],e()}},hr=function(t){lr.call(t.data)};ur&&ar||(ur=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return fr[++sr]=function(){ir("function"==typeof t?t:Function(t),e)},Un(sr),sr},ar=function(t){delete fr[t]},"process"==Ot(or)?Un=function(t){or.nextTick(U(lr,t,1))}:cr?(Jn=(Kn=new cr).port2,Kn.port1.onmessage=hr,Un=U(Jn.postMessage,Jn,1)):G.addEventListener&&"function"==typeof postMessage&&!G.importScripts?(Un=function(t){G.postMessage(t+"","*")},G.addEventListener("message",hr,!1)):Un="onreadystatechange"in Z("script")?function(t){Gt.appendChild(Z("script")).onreadystatechange=function(){Gt.removeChild(this),lr.call(t)}}:function(t){setTimeout(U(lr,t,1),0)});var dr,pr,vr,yr={set:ur,clear:ar},mr=yr.set,gr=G.MutationObserver||G.WebKitMutationObserver,wr=G.process,_r=G.Promise,br="process"==Ot(wr),Or=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:ot(t,r,e[r]);return t},Er=Jt("species"),xr=yr.set,kr=function(){var t,e,n,r=function(){var r,i;for(br&&(r=wr.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(br)n=function(){wr.nextTick(r)};else if(gr){var i=!0,o=document.createTextNode("");new gr(r).observe(o,{characterData:!0}),n=function(){o.data=i=!i}}else if(_r&&_r.resolve){var u=_r.resolve();n=function(){u.then(r)}}else n=function(){mr.call(G,r)};return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}(),Ar=G.TypeError,jr=G.process,Sr=G.Promise,jr=G.process,Pr="process"==Bn(jr),Mr=function(){},Tr=!!function(){try{var t=Sr.resolve(1),e=(t.constructor={})[Jt("species")]=function(t){t(Mr,Mr)};return(Pr||"function"==typeof PromiseRejectionEvent)&&t.then(Mr)instanceof e}catch(t){}}(),Lr=function(t,e){return t===e||t===Sr&&e===vr},Nr=function(t){var e;return!(!K(t)||"function"!=typeof(e=t.then))&&e},Fr=function(t){return Lr(Sr,t)?new Cr(t):new pr(t)},Cr=pr=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw Ar("Bad Promise constructor");e=t,n=r}),this.resolve=$(e),this.reject=$(n)},zr=function(t){try{t()}catch(t){return{error:t}}},Rr=function(t,e){if(!t._n){t._n=!0;var n=t._c;kr(function(){for(var r=t._v,i=1==t._s,o=0;n.length>o;)!function(e){var n,o,u=i?e.ok:e.fail,a=e.resolve,c=e.reject,s=e.domain;try{u?(i||(2==t._h&&Ir(t),t._h=1),!0===u?n=r:(s&&s.enter(),n=u(r),s&&s.exit()),n===e.promise?c(Ar("Promise-chain cycle")):(o=Nr(n))?o.call(n,a,c):a(n)):c(r)}catch(t){c(t)}}(n[o++]);t._c=[],t._n=!1,e&&!t._h&&Dr(t)})}},Dr=function(t){xr.call(G,function(){var e,n,r,i=t._v;if(Br(t)&&(e=zr(function(){Pr?jr.emit("unhandledRejection",i,t):(n=G.onunhandledrejection)?n({promise:t,reason:i}):(r=G.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=Pr||Br(t)?2:1),t._a=void 0,e)throw e.error})},Br=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,r=0;n.length>r;)if((e=n[r++]).fail||!Br(e.promise))return!1;return!0},Ir=function(t){xr.call(G,function(){var e;Pr?jr.emit("rejectionHandled",t):(e=G.onrejectionhandled)&&e({promise:t,reason:t._v})})},Hr=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Rr(e,!0))},Wr=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Ar("Promise can't be resolved itself");(e=Nr(t))?kr(function(){var r={_w:n,_d:!1};try{e.call(t,U(Wr,r,1),U(Hr,r,1))}catch(t){Hr.call(r,t)}}):(n._v=t,n._s=1,Rr(n,!1))}catch(t){Hr.call({_w:n,_d:!1},t)}}};Tr||(Sr=function(t){tr(this,Sr,"Promise","_h"),$(t),dr.call(this);try{t(U(Wr,this,1),U(Hr,this,1))}catch(t){Hr.call(this,t)}},(dr=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Or(Sr.prototype,{then:function(t,e){var n=Fr(rr(this,Sr));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Pr?jr.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Rr(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Cr=function(){var t=new dr;this.promise=t,this.resolve=U(Wr,t,1),this.reject=U(Hr,t,1)}),at(at.G+at.W+at.F*!Tr,{Promise:Sr}),Xt(Sr,"Promise"),function(t){var e="function"==typeof q[t]?q[t]:G[t];Y&&e&&!e[Er]&&rt.f(e,Er,{configurable:!0,get:function(){return this}})}("Promise"),vr=q.Promise,at(at.S+at.F*!Tr,"Promise",{reject:function(t){var e=Fr(this);return(0,e.reject)(t),e.promise}}),at(at.S+!0*at.F,"Promise",{resolve:function(t){if(t instanceof Sr&&Lr(t.constructor,this))return t;var e=Fr(this);return(0,e.resolve)(t),e.promise}}),at(at.S+at.F*!(Tr&&$n(function(t){Sr.all(t).catch(Mr)})),"Promise",{all:function(t){var e=this,n=Fr(e),r=n.resolve,i=n.reject,o=zr(function(){var n=[],o=0,u=1;er(t,!1,function(t){var a=o++,c=!1;n.push(void 0),u++,e.resolve(t).then(function(t){c||(c=!0,n[a]=t,--u||r(n))},i)}),--u||r(n)});return o&&i(o.error),n.promise},race:function(t){var e=this,n=Fr(e),r=n.reject,i=zr(function(){er(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i&&r(i.error),n.promise}});var Gr=q.Promise,qr=(e(function(t){t.exports={default:Gr,__esModule:!0}}),"undefined"!=typeof window&&Object.prototype.toString.call(window),window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return setTimeout(t,17)}),$r=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(t){clearTimeout(t)},Ur=Object.assign,Kr=!Ur||V(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=Ur({},t)[n]||Object.keys(Ur({},e)).join("")!=r})?function(t,e){for(var n=te(t),r=arguments.length,i=1,o=xe.f,u=ke.f;r>i;)for(var a,c=Et(arguments[i++]),s=o?Ht(c).concat(o(c)):Ht(c),f=s.length,l=0;f>l;)u.call(c,a=s[l++])&&(n[a]=c[a]);return n}:Ur;at(at.S+at.F,"Object",{assign:Kr});var Jr=q.Object.assign,Vr=t(e(function(t){t.exports={default:Jr,__esModule:!0}}));at(at.S,"Object",{create:Kt});var Yr=q.Object,Xr=function(t,e){return Yr.create(t,e)},Qr=t(e(function(t){t.exports={default:Xr,__esModule:!0}})),Zr=Qr(null);Zr.count=0;!function(){function t(e,n){var r=this;if(W(this,t),Object.defineProperty(this,"__target",{writable:!0,enumerable:!1,configurable:!0}),this.__target=this,e){if("object"!==(void 0===e?"undefined":pn(e)))throw new Error("CusEvent target are not object");this.__target=e,n&&["on","once","off","emit"].forEach(function(t){e[t]=r[t]})}}ht(t,[{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return v(this.__target,t,e,n),this}},{key:"once",value:function(t,e){return this.on(t,e,!0)}},{key:"off",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return y(this.__target,t,e,n),this}},{key:"emit",value:function(t,e){return p(this.__target,t,{data:e}),this}}])}();var ti=Qr(null);ti.count=0;(function(){function t(e,n){var r=this;if(W(this,t),Object.defineProperty(this,"__target",{writable:!0,enumerable:!1,configurable:!0}),this.__target=this,e){if("object"!==(void 0===e?"undefined":pn(e)))throw new Error("CusEvent target are not object");this.__target=e,n&&["on","once","off","emit"].forEach(function(t){e[t]=r[t]})}}ht(t,[{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return w(this.__target,t,e,n),this}},{key:"once",value:function(t,e){return this.on(t,e,!0)}},{key:"off",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _(this.__target,t,e,n),this}},{key:"emit",value:function(t,e){return g(this.__target,t,{data:e}),this}}])})(),"undefined"!=typeof window&&Object.prototype.toString.call(window);var ei=document.createElement("div"),ni="innerText";"textContent"in ei&&(ni="textContent");var ri=Array.prototype,ii=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;W(this,t);var i=this;i.selector=e;var o=void 0;e&&e.constructor===NodeList?o=b(e):r(e)?o=e:a(e)?0===e.indexOf("<")?(ei.innerHTML=e,o=N("*",ei,!0)):o=N(e,n,!0):o=[e],Vr(i,o),i.length=o.length}return ht(t,[{key:"each",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return ri.forEach.apply(this,e),this}},{key:"push",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return ri.push.apply(this,e),this}},{key:"splice",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return z(ri.splice.apply(this,e))}},{key:"find",value:function(t){var e=[];this.each(function(n){e=e.concat(N(t,n,!0))});var n=z(e);return n.parent=this,n.selector=t,n}},{key:"append",value:function(t){var e=z(t),n=this[0];return e.each(function(t){return n.appendChild(t)}),this}},{key:"appendTo",value:function(t){return z(t).append(this),this}},{key:"text",value:function(t){return 0===arguments.length?this[0][ni]:this.each(function(e){e[ni]=t})}},{key:"html",value:function(t){return 0===arguments.length?this[0].innerHTML:this.each(function(e){e.innerHTML=t})}},{key:"attr",value:function(t,e){return 1===arguments.length?O(this[0],t):this.each(function(n){return E(n,t,e)})}},{key:"data",value:function(t,e){return 0===arguments.length?this[0].dataset||{}:1===arguments.length?(this[0].dataset||{})[t]:this.each(function(n){(n.dataset||(n.dataset={}))[t]=e})}},{key:"css",value:function(t,e){return 1!==arguments.length||o(t)?this.each(function(n){return L(n,t,e)}):T(this[0],t)}},{key:"addClass",value:function(t){return this.each(function(e){return x(e,t)})}},{key:"removeClass",value:function(t){return this.each(function(e){return k(e,t)})}},{key:"hasClass",value:function(t){return A(this[0],t)}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return S(i,t,e,n,r)})}},{key:"off",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return j(i,t,e,n,r)})}},{key:"delegate",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return P(i,t,e,n,r)})}},{key:"undelegate",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return M(i,t,e,n,r)})}},{key:"remove",value:function(){return this.each(function(t){return F(t)})}}]),t}(),oi=function(){function t(e,n){W(this,t),this.create(e.pDom),this.thread=e.thread,this.renderTime=e.renderTime,this.timer=null,this.pDom=e.pDom,this.fontSize=n.fontSize,this.lineHeight=n.lineHeight}return ht(t,[{key:"create",value:function(t){var e=document.createElement("canvas");t.appendChild(e),this.layer=e,this.width=this.layer.width=t.offsetWidth,this.height=this.layer.height=t.offsetHeight,this.context=this.layer.getContext("2d")}},{key:"destroy",value:function(){$r.call(window,this.timer),this.layer.parentNode.removeChild(this.layer)}},{key:"createPiece",value:function(t){var e=document.createElement("canvas"),n=e.getContext("2d"),r="small"===t.fontSize?.6:1,i=Math.floor(r*this.fontSize)+"px",o=t.fontFamily||"serif";return n.font=i+" "+o,e.width=n.measureText(t.text).width,e.height=this.lineHeight,n.font=i+" "+o,n.textAlign="left",n.textBaseline="top",n.fillStyle=t.color||"#ffffff",n.fillText(t.text,0,0),e}},{key:"start",value:function(){this.render()}},{key:"pause",value:function(){$r.call(window,this.timer)}},{key:"draw",value:function(t){this.context.drawImage(t.piece,t.offset.x,t.offset.y,t.piece.width,t.piece.height)}},{key:"resize",value:function(){this.width=this.layer.width=this.pDom.offsetWidth,this.height=this.layer.height=this.pDom.offsetHeight,this.render(),this.pause()}},{key:"render",value:function(){var t=this;this.clear(),this.thread.pool.forEach(function(e,n){if(t.draw(e),"flow"===e.mode)e.offset.x-=e.speed,e.offset.x<-e.piece.width&&t.thread.remove(n);else{var r=new Date,i=e.row;e.startTime=e.startTime||new Date,r-e.startTime>5e3&&(t.thread.remove(n),t.thread.vRows[i].shift())}}),this.timer=qr.call(window,function(){t.render()})}},{key:"clear",value:function(){this.context.clearRect(0,0,this.layer.width,this.layer.height)}}]),t}(),ui=function(){function t(e,n){W(this,t),this.pool=[],this.pDom=e,this.config=n,this.resize()}return ht(t,[{key:"resize",value:function(){this.rows=Math.floor(parseInt(this.pDom.offsetHeight)/this.config.lineHeight),this.vRows=Vr(new Array(this.rows),this.vRows)}},{key:"get",value:function(t){return this.pool[t]}},{key:"push",value:function(t){this.pool.push(t)}},{key:"remove",value:function(t){this.pool.splice(t,1)}},{key:"empty",value:function(){this.pool=[],this.vRows=new Array(this.rows)}}]),t}(),ai=ze.f;vn("getOwnPropertyDescriptor",function(){return function(t,e){return ai(xt(t),e)}});var ci=q.Object,si=function(t,e){return ci.getOwnPropertyDescriptor(t,e)},fi=t(e(function(t){t.exports={default:si,__esModule:!0}})),li=G.Reflect,hi=li&&li.ownKeys||function(t){var e=Pe.f(J(t)),n=xe.f;return n?e.concat(n(t)):e};at(at.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n=xt(t),r=ze.f,i=hi(n),o={},u=0;i.length>u;)Cn(o,e=i[u++],r(n,e));return o}});var di=q.Object.getOwnPropertyDescriptors,pi=t(e(function(t){t.exports={default:di,__esModule:!0}})),vi=q.Object.getOwnPropertySymbols,yi=t(e(function(t){t.exports={default:vi,__esModule:!0}}));vn("getOwnPropertyNames",function(){return Fe.f});var mi=q.Object,gi=function(t){return mi.getOwnPropertyNames(t)},wi=t(e(function(t){t.exports={default:gi,__esModule:!0}})),_i=Jt("iterator"),bi=q.isIterable=function(t){var e=Object(t);return void 0!==e[_i]||"@@iterator"in e||_t.hasOwnProperty(Bn(e))},Oi=e(function(t){t.exports={default:bi,__esModule:!0}}),Ei=q.getIterator=function(t){var e=Hn(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return J(e.call(t))},xi=e(function(t){t.exports={default:Ei,__esModule:!0}});e(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(Oi),i=n(xi);e.default=function(){function t(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var a,c=(0,i.default)(t);!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{!r&&c.return&&c.return()}finally{if(o)throw u}}return n}return function(e,n){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()});vn("getPrototypeOf",function(){return function(t){return re(te(t))}});var ki=q.Object.getPrototypeOf,Ai=t(e(function(t){t.exports={default:ki,__esModule:!0}})),ji=Jt("species"),Si=function(t){var e;return je(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!je(e.prototype)||(e=void 0),K(e)&&null===(e=e[ji])&&(e=void 0)),void 0===e?Array:e},Pi=function(t,e){return new(Si(t))(e)},Mi=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,u=6==t,a=5==t||u,c=e||Pi;return function(e,s,f){for(var l,h,d=te(e),p=Et(d),v=U(s,f,3),y=At(p.length),m=0,g=n?c(e,y):r?c(e,0):void 0;y>m;m++)if((a||m in p)&&(l=p[m],h=v(l,m,d),t))if(n)g[m]=h;else if(h)switch(t){case 3:return!0;case 5:return l;case 6:return m;case 2:g.push(l)}else if(o)return!1;return u?-1:i||o?o:g}},Ti=_e.getWeak,Li=Mi(5),Ni=Mi(6),Fi=0,Ci=function(t){return t._l||(t._l=new zi)},zi=function(){this.a=[]},Ri=function(t,e){return Li(t.a,function(t){return t[0]===e})};zi.prototype={get:function(t){var e=Ri(this,t);if(e)return e[1]},has:function(t){return!!Ri(this,t)},set:function(t,e){var n=Ri(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=Ni(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}};var Di={getConstructor:function(t,e,n,r){var i=t(function(t,o){tr(t,i,e,"_i"),t._i=Fi++,t._l=void 0,void 0!=o&&er(o,n,t[r],t)});return Or(i.prototype,{delete:function(t){if(!K(t))return!1;var e=Ti(t);return!0===e?Ci(this).delete(t):e&&wt(e,this._i)&&delete e[this._i]},has:function(t){if(!K(t))return!1;var e=Ti(t);return!0===e?Ci(this).has(t):e&&wt(e,this._i)}}),i},def:function(t,e,n){var r=Ti(J(e),!0);return!0===r?Ci(t).set(e,n):r[t._i]=n,t},ufstore:Ci},Bi=rt.f,Ii=Mi(0),Hi=function(t,e,n,r,i,o){var u=G[t],a=u,c=i?"set":"add",s=a&&a.prototype,f={};return Y&&"function"==typeof a&&(o||s.forEach&&!V(function(){(new a).entries().next()}))?(a=e(function(e,n){tr(e,a,t,"_c"),e._c=new u,void 0!=n&&er(n,i,e[c],e)}),Ii("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in s&&(!o||"clear"!=t)&&ot(a.prototype,t,function(n,r){if(tr(this,a,t),!e&&o&&!K(n))return"get"==t&&void 0;var i=this._c[t](0===n?0:n,r);return e?this:i})}),"size"in s&&Bi(a.prototype,"size",{get:function(){return this._c.size}})):(a=r.getConstructor(e,t,i,c),Or(a.prototype,n),_e.NEED=!0),Xt(a,t),f[t]=a,at(at.G+at.W+at.F,f),o||r.setStrong(a,t,i),a},Wi=(e(function(t){var e,n=Mi(0),r=_e.getWeak,i=Object.isExtensible,o=Di.ufstore,u={},a=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},c={get:function(t){if(K(t)){var e=r(t);return!0===e?o(this).get(t):e?e[this._i]:void 0}},set:function(t,e){return Di.def(this,t,e)}},s=t.exports=Hi("WeakMap",a,c,Di,!0,!0);7!=(new s).set((Object.freeze||Object)(u),7).get(u)&&(e=Di.getConstructor(a),Kr(e.prototype,c),_e.NEED=!0,n(["delete","has","get","set"],function(t){var n=s.prototype,r=n[t];mt(n,t,function(n,o){if(K(n)&&!i(n)){this._f||(this._f=new e);var u=this._f[t](n,o);return"set"==t?this:u}return r.call(this,n,o)})}))}),q.WeakMap),Gi=t(e(function(t){t.exports={default:Wi,__esModule:!0}})),qi=(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(ft);e.default=function(t,e,r){return e in t?(0,n.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}}),_e.onFreeze);vn("preventExtensions",function(t){return function(e){return t&&K(e)?t(qi(e)):e}});var $i,Ui=q.Object.preventExtensions,Ki=(e(function(t){t.exports={default:Ui,__esModule:!0}}),wi),Ji=yi,Vi=fi,Yi=i(Ji)?function(t){return Xn(Ki(t).concat(Ji(t)))}:Ki,Xi=i(pi)?pi:function(t){return Yi(t).reduce(function(e,n){return e[n]=Vi(t,n),e},{})},Qi=lt,Zi=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.requirement,u=e.customArgs,a=void 0!==u&&u;return function(){for(var e=arguments.length,u=Array(e>1?e-1:0),c=1;c<e;c++)u[c-1]=arguments[c];var f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=f.exclude,h=void 0===l?[]:l,d=f.include,p=void 0===d?[]:d,v=f.construct,y=void 0!==v&&v,m=f.self,g=void 0!==m&&m;if(!r(h))throw new TypeError("options.exclude must be an array");if(!r(p))throw new TypeError("options.include must be an array");return function(e){var r=i(e);if(!g&&!r)throw new TypeError("@"+t.name+"Class can only be used on class");if(g&&s(e))throw new TypeError("@"+t.name+"Class must be used on non-primitive type value in 'self' mode");var c=g?e:e.prototype;if(n(c))throw new Error("The prototype of the "+e.name+" is empty, please check it");var f=Xi(c);Yi(c).concat(p).forEach(function(e){var n=f[e];"constructor"===e&&!y||g&&r&&["name","length","prototype"].indexOf(e)>-1||h.indexOf(e)>-1||i(o)&&!1===o(c,e,n,{self:g})||Qi(c,e,(a?t.apply(void 0,Qn(u)):t)(c,e,n))})}}}(H,{requirement:function(t,e,n){return D(n)&&i(n.value)}}),to=void 0,eo=($i=function(){function t(e,n){W(this,t),this.create(e.pDom),this.thread=e.thread,this.renderTime=e.renderTime,this.timer=null,this.pDom=e.pDom,this.fontSize=n.fontSize,this.lineHeight=n.lineHeight}return ht(t,[{key:"create",value:function(t){var e=document.createElement("div");t.appendChild(e),this.layer=e,this.width=t.offsetWidth,this.height=t.offsetHeight}},{key:"destroy",value:function(){$r.call(window,this.timer),this.layer.parentNode.removeChild(this.layer)}},{key:"createPiece",value:function(t){var e="small"===t.fontSize?.6:1,n=Math.floor(e*this.fontSize)+"px",r=t.fontFamily||"serif",i=t.color||"#ffffff",o=document.createElement("div");return o.className="danmu-piece",L(o,{color:i,fontSize:n,fontFamily:r,transform:"translateX(-9999px)"}),o.textContent=t.text,this.layer.appendChild(o),o.width=o.offsetWidth,o.height=this.lineHeight,o}},{key:"start",value:function(){this.render()}},{key:"pause",value:function(){$r.call(window,this.timer)}},{key:"resize",value:function(){this.width=this.pDom.offsetWidth,this.height=this.pDom.offsetHeight}},{key:"render",value:function(){var t=this;this.thread.pool.forEach(function(e,n){if(L(e.piece,"transform","translateX("+e.offset.x+"px) translateY("+e.offset.y+"px) "),"flow"===e.mode)e.offset.x-=e.speed,e.offset.x<-e.piece.width&&(e.piece.parentNode.removeChild(e.piece),t.thread.remove(n));else{var r=new Date,i=e.row;e.startTime=e.startTime||new Date,r-e.startTime>5e3&&(e.piece.parentNode.removeChild(e.piece),t.thread.remove(n),t.thread.vRows[i].shift())}}),this.timer=qr.call(window,this.render)}},{key:"clear",value:function(){this.layer.innerHTML=""}}]),t}(),function(t,e,n,r,i){var o={};Object.keys(r).forEach(function(t){o[t]=r[t]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(t,e,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null)}($i.prototype,"render",[H],fi($i.prototype,"render"),$i.prototype),$i),no=function(){function t(e,n){W(this,t),this.plugin=e,this.pDom=e.$dom,this.config=n,this.thread=new ui(e.$dom,n),this.changeMode(n.mode||"css"),this.lineHeight=n.lineHeight,this.timer=null}return ht(t,[{key:"start",value:function(){this.paper.start()}},{key:"pause",value:function(){this.paper.pause()}},{key:"clear",value:function(){this.thread.empty(),this.paper&&this.paper.clear()}},{key:"destroy",value:function(){this.paper.destroy()}},{key:"resize",value:function(){this.paper.resize(),this.thread.resize()}},{key:"changeMode",value:function(t){t&&t!==this.mode&&(this.thread.empty(),this.paper&&this.destroy(),this.paper="canvas"===t?new oi(this,this.config):new eo(this,this.config),!this.plugin.paused&&this.paper.start(),this.mode=t)}},{key:"_line",value:function(t){for(var e=this.thread.pool,n=e.length,r=new Array(this.thread.rows),i=0,o=n-1;o>=0;o--)if("flow"===e[o].mode){var u=e[o].row;r[u]=r[u]?r[u]:e[o]}for(var a=0,c=0;c<r.length;c++){if(!r[c]){i=c;break}var s=r[c].offset.x+r[c].piece.width;if(t.width<this.paper.width-s){i=c;break}(!a||s<a)&&(a=s,i=r[c].row)}return i}},{key:"_vLine",value:function(t){var e=this.thread.vRows,n=e.length,r=0;return r=e.every(function(t,n){return Array.isArray(e[0])&&t.length===e[0].length})?"top"===t.mode?0:n-1:this._cLine(e,t),e[r]=e[r]?e[r].concat(t):[t],r}},{key:"_cLine",value:function(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=0===i?n-1:i-1,u=i===n-1?0:i+1,a=Array.isArray(t[o])?t[o].length:0,c=Array.isArray(t[u])?t[u].length:0,s=Array.isArray(t[i])?t[i].length:0;(!s||s<a||s<c)&&r.push(i)}return"top"===e.node?r[0]:r[r.length-1]}},{key:"emit",value:function(t){if("close"!==this.status){var e={};"string"==typeof t?e.text=t:e=t,(t=l({text:"你真的很漂亮",mode:"flow",fontSize:"big",color:"#fff"},e)).mode=t.mode||"flow";var n=this.paper.createPiece(t),r="flow"===t.mode?this._line(n):this._vLine(t);this.thread.pool.push({piece:n,text:t.text,mode:t.mode,speed:.3*Math.pow(n.width,1/3),row:r,offset:{x:"flow"===t.mode?this.paper.width:(this.paper.width-n.width)/2,y:this.lineHeight*r}})}}}]),t}();!function(t,e){if("undefined"==typeof document)return e;t=t||"";var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}("chimee-danmu{position:absolute;top:0;left:0;display:block;width:100%;height:100%;overflow:hidden}chimee-danmu>div{width:100%;height:100%;user-select:none}chimee-danmu .danmu-piece{position:absolute;left:0;top:0;display:inline-block;white-space:pre;pointer-events:none;font-weight:400;line-height:1.125;opacity:1;text-shadow:#000 1px 0 1px,#000 0 1px 1px,#000 0 -1px 1px,#000 -1px 0 1px}",void 0);var ro={lineHeight:30,fontSize:24,mode:"css"};return{name:"chimeeDanmu",el:"chimee-danmu",data:{status:"open",danmu:{},danmuList:[],currentPostion:0,currentPiece:{}},operable:!0,penetrate:!0,level:-1,create:function(){},init:function(t){if(!t||!1!==t.danmu){var e=o(this.$config)?l(ro,this.$config):ro;this.danmu=new no(this,e),S(window,"resize",this._resize)}},inited:function(){},destroy:function(){this.danmu.destroy(),this.$dom.parentNode.removeChild(this.$dom),j(window,"resize",this._resize)},events:{play:function(){"open"===this.status&&this.danmu.start()},pause:function(){"open"===this.status&&this.danmu.pause()},timeupdate:function(){if("close"!==this.status)for((Math.abs(this.currentTime-this.currentPiece.time)>1||void 0===this.currentPiece.time)&&this.__searchPosition();this.currentTime>=this.currentPiece.time&&this.currentPiece.time;)this.danmu.emit(this.currentPiece),this.currentPiece=this.danmuList[this.currentPostion++]||{}},contextmenu:function(){}},methods:{__searchPosition:function(){var t=this.danmuList.length;if(0!==t){if(this.currentTime>this.danmuList[t-1].time)return this.currentPiece={},void(this.currentPostion=t+1);if(this.currentTime<this.danmuList[0].time)return this.currentPiece=this.danmuList[0],void(this.currentPostion=0);for(var e=0;e<t;e++){var n=this.danmuList[e];if(n.time>=this.currentTime){this.currentPostion=e,this.currentPiece=n;break}}}},open:function(){this.status="open"},close:function(){this.status="close",this.danmu.clear(),this.danmu.pause()},start:function(){this.danmu.start()},pause:function(){this.danmu.pause()},changeMode:function(t){this.danmu.changeMode(t)},sendMsg:function(t){"open"===this.status&&this.danmu.emit(t)},receiveData:function(t){this.danmuList=t,this.currentPiece=this.danmuList[this.currentPostion++]||{}},_resize:function(){this.danmu.resize()}}}});
