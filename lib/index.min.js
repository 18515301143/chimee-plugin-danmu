!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function t(t){return t&&t.__esModule?t.default:t}function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}function n(t){return void 0===t||null===t}function r(t){return Array.isArray(t)}function i(t){return"function"==typeof t}function o(t){return Object(t)===t&&"[object Object]"===String(t)&&!i(t)&&!r(t)}function u(t){return"number"==typeof t}function a(t){return"string"==typeof t||t instanceof String}function c(t){return"boolean"==typeof t}function s(t){return n(t)||c(t)||a(t)||u(t)}function f(t,e){if(!a(t))throw new TypeError("Log's method only acccept string as argument");return a(e)?"["+(t=En.FORCE_GLOBAL_TAG?En.GLOBAL_TAG:t||En.GLOBAL_TAG)+"] > "+e:"["+En.GLOBAL_TAG+"] > "+t}function l(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e.length<2)throw new Error("deepAssign accept two and more argument");for(var r=e.length-1;r>-1;r--)if(s(e[r]))throw new TypeError("deepAssign only accept non primitive type");var i=e.shift();return e.forEach(function(t){return qn(t,i)}),i}function h(t,e){var n=t.__evt_id;n||(Object.defineProperty(t,"__evt_id",{writable:!0,enumerable:!1,configurable:!0}),n=t.__evt_id=++Wr.count);var r=n+"_"+e,i=Wr[r];return i||(i=Wr[r]=[]),i}function d(t,e,n){var r=Gr(null);r.type=e,r.target=t,n&&Dr(r,o(n)?n:{data:n}),h(t,e).forEach(function(e){(e[1]||e[0]).apply(t,[r])})}function p(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];i(r)&&!o&&(o=r,r=void 0);var u=[n,void 0,r];r&&!o&&(o=function(){v(t,e,n,r);for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];n.apply(t,o)}),o&&(u[1]=o),h(t,e).push(u)}function v(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=h(t,e);if(n||r){var o=-1,u=void 0;return i.find(function(t,e){if((!n||t[0]===n)&&(!r||t[2]))return o=e,u=t[1],!0}),-1!==o&&i.splice(o,1),u}i.length=0}function y(t,e){var n=t.__evt_id;n||(Object.defineProperty(t,"__evt_id",{writable:!0,enumerable:!1,configurable:!0}),n=t.__evt_id=++qr.count);var r=n+"_"+e,i=qr[r];return i||(i=qr[r]=[]),i}function m(t,e,n){var r=Gr(null);r.type=e,r.target=t,n&&Dr(r,o(n)?n:{data:n}),y(t,e).forEach(function(e){(e[1]||e[0]).apply(t,[r])})}function g(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];i(r)&&!o&&(o=r,r=void 0);var u=[n,void 0,r];r&&!o&&(o=function(){w(t,e,n,r);for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];n.apply(t,o)}),o&&(u[1]=o),y(t,e).push(u)}function w(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=y(t,e);if(n||r){var o=-1,u=void 0;return i.find(function(t,e){if((!n||t[0]===n)&&(!r||t[2]))return o=e,u=t[1],!0}),-1!==o&&i.splice(o,1),u}i.length=0}function _(t){return Wn(t)}function b(t,e){return t.getAttribute(e)}function E(t,e,n){void 0===n?t.removeAttribute(e):t.setAttribute(e,n)}function k(t,e){if(e&&(e=e.trim())){var n=e.split(/\s+/);if(t.classList)n.forEach(function(e){return t.classList.add(e)});else{var r=" "+(t.className||"")+" ";n.forEach(function(t){-1===r.indexOf(" "+t+" ")&&(r+=" "+t)}),t.className=r.trim()}}}function O(t,e){if(e&&(e=e.trim())){var n=e.split(/\s+/);if(t.classList)n.forEach(function(e){return t.classList.remove(e)});else{var r=" "+t.className+" ";n.forEach(function(t){for(var e=" "+t+" ";-1!==r.indexOf(e);)r=r.replace(e," ")}),t.className=r.trim()}}}function A(t,e){return new RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t.className)}function x(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(r){var o=w(t,e+"_once",n);o&&(n=o)}t.removeEventListener(e,n,i)}function S(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(r){var o=n;g(t,e+"_once",o,n=function(){for(var u=arguments.length,a=Array(u),c=0;c<u;c++)a[c]=arguments[c];o.apply(this,a),x(t,e,n,r,i)})}t.addEventListener(e,n,i)}function j(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(n){var i=F(n.srcElement,t,!0),o=M(e,t,!0).find(function(t){return i.find(function(e){return t===e})});o&&r.apply(o,arguments)};g(t,n+"_delegate_"+e,r,o),t.addEventListener(n,o,i)}function P(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=w(t,n+"_delegate_"+e,r);o&&t.removeEventListener(n,o,i)}function L(t,e){return(t.currentStyle||document.defaultView.getComputedStyle(t,null))[e]||t.style[e]}function T(t,e,n){if(o(e))for(var r in e)T(t,r,e[r]);else t.style[e]=n}function M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=arguments[2],r=e.querySelectorAll(t);return n?Wn(r):r}function N(t){t.parentNode.removeChild(t)}function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],r=arguments[3],i=[];for(n&&i.push(t);t&&t.parentNode!==e;)(t=t.parentNode)&&i.push(t);return r&&i.push(e),i}function C(t,e){return t.constructor===Jr?t:new Jr(t,e)}var R=t(e(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),z=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),B=e(function(t){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)}),D=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},H=function(t,e,n){if(D(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},I=function(t){return"object"==typeof t?null!==t:"function"==typeof t},G=function(t){if(!I(t))throw TypeError(t+" is not an object!");return t},W=function(t){try{return!!t()}catch(t){return!0}},q=!W(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),$=z.document,U=I($)&&I($.createElement),K=function(t){return U?$.createElement(t):{}},J=!q&&!W(function(){return 7!=Object.defineProperty(K("div"),"a",{get:function(){return 7}}).a}),V=function(t,e){if(!I(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!I(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!I(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!I(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},Y=Object.defineProperty,X={f:q?Object.defineProperty:function(t,e,n){if(G(t),e=V(e,!0),G(n),J)try{return Y(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},Q=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Z=q?function(t,e,n){return X.f(t,e,Q(1,n))}:function(t,e,n){return t[e]=n,t},tt=function(t,e,n){var r,i,o,u=t&tt.F,a=t&tt.G,c=t&tt.S,s=t&tt.P,f=t&tt.B,l=t&tt.W,h=a?B:B[e]||(B[e]={}),d=h.prototype,p=a?z:c?z[e]:(z[e]||{}).prototype;a&&(n=e);for(r in n)(i=!u&&p&&void 0!==p[r])&&r in h||(o=i?p[r]:n[r],h[r]=a&&"function"!=typeof p[r]?n[r]:f&&i?H(o,z):l&&p[r]==o?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(o):s&&"function"==typeof o?H(Function.call,o):o,s&&((h.virtual||(h.virtual={}))[r]=o,t&tt.R&&d&&!d[r]&&Z(d,r,o)))};tt.F=1,tt.G=2,tt.S=4,tt.P=8,tt.B=16,tt.W=32,tt.U=64,tt.R=128;var et=tt;et(et.S+et.F*!q,"Object",{defineProperty:X.f});var nt=B.Object,rt=function(t,e,n){return nt.defineProperty(t,e,n)},it=e(function(t){t.exports={default:rt,__esModule:!0}}),ot=t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(it);e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,n.default)(t,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()})),ut=Math.ceil,at=Math.floor,ct=function(t){return isNaN(t=+t)?0:(t>0?at:ut)(t)},st=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},ft=Z,lt={}.hasOwnProperty,ht=function(t,e){return lt.call(t,e)},dt={},pt={}.toString,vt=function(t){return pt.call(t).slice(8,-1)},yt=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==vt(t)?t.split(""):Object(t)},mt=function(t){return yt(st(t))},gt=Math.min,wt=function(t){return t>0?gt(ct(t),9007199254740991):0},_t=Math.max,bt=Math.min,Et=function(t,e){return(t=ct(t))<0?_t(t+e,0):bt(t,e)},kt=z["__core-js_shared__"]||(z["__core-js_shared__"]={}),Ot=function(t){return kt[t]||(kt[t]={})},At=0,xt=Math.random(),St=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++At+xt).toString(36))},jt=Ot("keys"),Pt=function(t){return jt[t]||(jt[t]=St(t))},Lt=function(t){return function(e,n,r){var i,o=mt(e),u=wt(o.length),a=Et(r,u);if(t&&n!=n){for(;u>a;)if((i=o[a++])!=i)return!0}else for(;u>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}}(!1),Tt=Pt("IE_PROTO"),Mt=function(t,e){var n,r=mt(t),i=0,o=[];for(n in r)n!=Tt&&ht(r,n)&&o.push(n);for(;e.length>i;)ht(r,n=e[i++])&&(~Lt(o,n)||o.push(n));return o},Nt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Ft=Object.keys||function(t){return Mt(t,Nt)},Ct=q?Object.defineProperties:function(t,e){G(t);for(var n,r=Ft(e),i=r.length,o=0;i>o;)X.f(t,n=r[o++],e[n]);return t},Rt=z.document&&document.documentElement,zt=Pt("IE_PROTO"),Bt=function(){},Dt=function(){var t,e=K("iframe"),n=Nt.length;for(e.style.display="none",Rt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Dt=t.F;n--;)delete Dt.prototype[Nt[n]];return Dt()},Ht=Object.create||function(t,e){var n;return null!==t?(Bt.prototype=G(t),n=new Bt,Bt.prototype=null,n[zt]=t):n=Dt(),void 0===e?n:Ct(n,e)},It=e(function(t){var e=Ot("wks"),n=z.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:St)("Symbol."+t))}).store=e}),Gt=X.f,Wt=It("toStringTag"),qt=function(t,e,n){t&&!ht(t=n?t:t.prototype,Wt)&&Gt(t,Wt,{configurable:!0,value:e})},$t={};Z($t,It("iterator"),function(){return this});var Ut=function(t,e,n){t.prototype=Ht($t,{next:Q(1,n)}),qt(t,e+" Iterator")},Kt=function(t){return Object(st(t))},Jt=Pt("IE_PROTO"),Vt=Object.prototype,Yt=Object.getPrototypeOf||function(t){return t=Kt(t),ht(t,Jt)?t[Jt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Vt:null},Xt=It("iterator"),Qt=!([].keys&&"next"in[].keys()),Zt=function(){return this},te=function(t,e,n,r,i,o,u){Ut(n,e,r);var a,c,s,f=function(t){if(!Qt&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},l=e+" Iterator",h="values"==i,d=!1,p=t.prototype,v=p[Xt]||p["@@iterator"]||i&&p[i],y=v||f(i),m=i?h?f("entries"):y:void 0,g="Array"==e?p.entries||v:v;if(g&&(s=Yt(g.call(new t)))!==Object.prototype&&qt(s,l,!0),h&&v&&"values"!==v.name&&(d=!0,y=function(){return v.call(this)}),u&&(Qt||d||!p[Xt])&&Z(p,Xt,y),dt[e]=y,dt[l]=Zt,i)if(a={values:h?y:f("values"),keys:o?y:f("keys"),entries:m},u)for(c in a)c in p||ft(p,c,a[c]);else et(et.P+et.F*(Qt||d),e,a);return a},ee=function(t){return function(e,n){var r,i,o=String(st(e)),u=ct(n),a=o.length;return u<0||u>=a?t?"":void 0:(r=o.charCodeAt(u))<55296||r>56319||u+1===a||(i=o.charCodeAt(u+1))<56320||i>57343?t?o.charAt(u):r:t?o.slice(u,u+2):i-56320+(r-55296<<10)+65536}}(!0);te(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=ee(e,n),this._i+=t.length,{value:t,done:!1})});var ne=function(){},re=function(t,e){return{value:e,done:!!t}};te(Array,"Array",function(t,e){this._t=mt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,re(1)):"keys"==e?re(0,n):"values"==e?re(0,t[n]):re(0,[n,t[n]])},"values");dt.Arguments=dt.Array,ne(),ne(),ne();for(var ie=It("toStringTag"),oe=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],ue=0;ue<5;ue++){var ae=oe[ue],ce=z[ae],se=ce&&ce.prototype;se&&!se[ie]&&Z(se,ie,ae),dt[ae]=dt.Array}var fe={f:It},le=fe.f("iterator"),he=e(function(t){t.exports={default:le,__esModule:!0}}),de=e(function(t){var e=St("meta"),n=X.f,r=0,i=Object.isExtensible||function(){return!0},o=!W(function(){return i(Object.preventExtensions({}))}),u=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},a=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!I(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!ht(t,e)){if(!i(t))return"F";if(!n)return"E";u(t)}return t[e].i},getWeak:function(t,n){if(!ht(t,e)){if(!i(t))return!0;if(!n)return!1;u(t)}return t[e].w},onFreeze:function(t){return o&&a.NEED&&i(t)&&!ht(t,e)&&u(t),t}}}),pe=X.f,ve=function(t){var e=B.Symbol||(B.Symbol={});"_"==t.charAt(0)||t in e||pe(e,t,{value:fe.f(t)})},ye=function(t,e){for(var n,r=mt(t),i=Ft(r),o=i.length,u=0;o>u;)if(r[n=i[u++]]===e)return n},me={f:Object.getOwnPropertySymbols},ge={f:{}.propertyIsEnumerable},we=function(t){var e=Ft(t),n=me.f;if(n)for(var r,i=n(t),o=ge.f,u=0;i.length>u;)o.call(t,r=i[u++])&&e.push(r);return e},_e=Array.isArray||function(t){return"Array"==vt(t)},be=Nt.concat("length","prototype"),Ee={f:Object.getOwnPropertyNames||function(t){return Mt(t,be)}},ke=Ee.f,Oe={}.toString,Ae="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xe=function(t){try{return ke(t)}catch(t){return Ae.slice()}},Se={f:function(t){return Ae&&"[object Window]"==Oe.call(t)?xe(t):ke(mt(t))}},je=Object.getOwnPropertyDescriptor,Pe={f:q?je:function(t,e){if(t=mt(t),e=V(e,!0),J)try{return je(t,e)}catch(t){}if(ht(t,e))return Q(!ge.f.call(t,e),t[e])}},Le=de.KEY,Te=Pe.f,Me=X.f,Ne=Se.f,Fe=z.Symbol,Ce=z.JSON,Re=Ce&&Ce.stringify,ze=It("_hidden"),Be=It("toPrimitive"),De={}.propertyIsEnumerable,He=Ot("symbol-registry"),Ie=Ot("symbols"),Ge=Ot("op-symbols"),We=Object.prototype,qe="function"==typeof Fe,$e=z.QObject,Ue=!$e||!$e.prototype||!$e.prototype.findChild,Ke=q&&W(function(){return 7!=Ht(Me({},"a",{get:function(){return Me(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=Te(We,e);r&&delete We[e],Me(t,e,n),r&&t!==We&&Me(We,e,r)}:Me,Je=function(t){var e=Ie[t]=Ht(Fe.prototype);return e._k=t,e},Ve=qe&&"symbol"==typeof Fe.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Fe},Ye=function(t,e,n){return t===We&&Ye(Ge,e,n),G(t),e=V(e,!0),G(n),ht(Ie,e)?(n.enumerable?(ht(t,ze)&&t[ze][e]&&(t[ze][e]=!1),n=Ht(n,{enumerable:Q(0,!1)})):(ht(t,ze)||Me(t,ze,Q(1,{})),t[ze][e]=!0),Ke(t,e,n)):Me(t,e,n)},Xe=function(t,e){G(t);for(var n,r=we(e=mt(e)),i=0,o=r.length;o>i;)Ye(t,n=r[i++],e[n]);return t},Qe=function(t){var e=De.call(this,t=V(t,!0));return!(this===We&&ht(Ie,t)&&!ht(Ge,t))&&(!(e||!ht(this,t)||!ht(Ie,t)||ht(this,ze)&&this[ze][t])||e)},Ze=function(t,e){if(t=mt(t),e=V(e,!0),t!==We||!ht(Ie,e)||ht(Ge,e)){var n=Te(t,e);return!n||!ht(Ie,e)||ht(t,ze)&&t[ze][e]||(n.enumerable=!0),n}},tn=function(t){for(var e,n=Ne(mt(t)),r=[],i=0;n.length>i;)ht(Ie,e=n[i++])||e==ze||e==Le||r.push(e);return r},en=function(t){for(var e,n=t===We,r=Ne(n?Ge:mt(t)),i=[],o=0;r.length>o;)!ht(Ie,e=r[o++])||n&&!ht(We,e)||i.push(Ie[e]);return i};qe||(ft((Fe=function(){if(this instanceof Fe)throw TypeError("Symbol is not a constructor!");var t=St(arguments.length>0?arguments[0]:void 0),e=function(n){this===We&&e.call(Ge,n),ht(this,ze)&&ht(this[ze],t)&&(this[ze][t]=!1),Ke(this,t,Q(1,n))};return q&&Ue&&Ke(We,t,{configurable:!0,set:e}),Je(t)}).prototype,"toString",function(){return this._k}),Pe.f=Ze,X.f=Ye,Ee.f=Se.f=tn,ge.f=Qe,me.f=en,fe.f=function(t){return Je(It(t))}),et(et.G+et.W+et.F*!qe,{Symbol:Fe});for(var nn="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rn=0;nn.length>rn;)It(nn[rn++]);for(var nn=Ft(It.store),rn=0;nn.length>rn;)ve(nn[rn++]);et(et.S+et.F*!qe,"Symbol",{for:function(t){return ht(He,t+="")?He[t]:He[t]=Fe(t)},keyFor:function(t){if(Ve(t))return ye(He,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){Ue=!0},useSimple:function(){Ue=!1}}),et(et.S+et.F*!qe,"Object",{create:function(t,e){return void 0===e?Ht(t):Xe(Ht(t),e)},defineProperty:Ye,defineProperties:Xe,getOwnPropertyDescriptor:Ze,getOwnPropertyNames:tn,getOwnPropertySymbols:en}),Ce&&et(et.S+et.F*(!qe||W(function(){var t=Fe();return"[null]"!=Re([t])||"{}"!=Re({a:t})||"{}"!=Re(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!Ve(t)){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);return"function"==typeof(e=r[1])&&(n=e),!n&&_e(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!Ve(e))return e}),r[1]=e,Re.apply(Ce,r)}}}),Fe.prototype[Be]||Z(Fe.prototype,Be,Fe.prototype.valueOf),qt(Fe,"Symbol"),qt(Math,"Math",!0),qt(z.JSON,"JSON",!0),ve("asyncIterator"),ve("observable");var on=B.Symbol,un=e(function(t){t.exports={default:on,__esModule:!0}}),an=t(e(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(he),i=n(un),o="function"==typeof i.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};e.default="function"==typeof i.default&&"symbol"===o(r.default)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":o(t)}}));!function(t,e){var n=(B.Object||{})[t]||Object[t],r={};r[t]=e(n),et(et.S+et.F*W(function(){n(1)}),"Object",r)}("keys",function(){return function(t){return Ft(Kt(t))}});var cn=B.Object.keys,sn=(e(function(t){t.exports={default:cn,__esModule:!0}}),Math.floor);et(et.S,"Number",{isInteger:function(t){return!I(t)&&isFinite(t)&&sn(t)===t}});var fn=B.Number.isInteger,ln=(e(function(t){t.exports={default:fn,__esModule:!0}}),"\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"),hn="["+ln+"]",dn=RegExp("^"+hn+hn+"*"),pn=RegExp(hn+hn+"*$"),vn=function(t,e,n){var r={},i=W(function(){return!!ln[t]()||"​"!="​"[t]()}),o=r[t]=i?e(yn):ln[t];n&&(r[n]=o),et(et.P+et.F*i,"String",r)},yn=vn.trim=function(t,e){return t=String(st(t)),1&e&&(t=t.replace(dn,"")),2&e&&(t=t.replace(pn,"")),t},mn=vn,gn=z.parseFloat,wn=mn.trim,_n=1/gn(ln+"-0")!=-1/0?function(t){var e=wn(String(t),3),n=gn(e);return 0===n&&"-"==e.charAt(0)?-0:n}:gn;et(et.S+et.F*(Number.parseFloat!=_n),"Number",{parseFloat:_n});var bn=parseFloat,En=(e(function(t){t.exports={default:bn,__esModule:!0}}),function(){function t(){R(this,t)}return ot(t,null,[{key:"error",value:function(e,n){t.ENABLE_ERROR&&(console.error||console.warn||console.log)(f(e,n))}},{key:"info",value:function(e,n){t.ENABLE_INFO&&(console.info||console.log)(f(e,n))}},{key:"warn",value:function(e,n){t.ENABLE_WARN&&(console.warn||console.log)(f(e,n))}},{key:"debug",value:function(e,n){t.ENABLE_DEBUG&&(console.debug||console.log)(f(e,n))}},{key:"verbose",value:function(e,n){t.ENABLE_VERBOSE&&console.log(f(e,n))}}]),t}());En.GLOBAL_TAG="chimee",En.FORCE_GLOBAL_TAG=!1,En.ENABLE_ERROR=!0,En.ENABLE_INFO=!0,En.ENABLE_WARN=!0,En.ENABLE_DEBUG=!0,En.ENABLE_VERBOSE=!0;var kn=function(t,e,n,r){try{return r?e(G(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&G(i.call(t)),e}},On=It("iterator"),An=Array.prototype,xn=function(t){return void 0!==t&&(dt.Array===t||An[On]===t)},Sn=function(t,e,n){e in t?X.f(t,e,Q(0,n)):t[e]=n},jn=It("toStringTag"),Pn="Arguments"==vt(function(){return arguments}()),Ln=function(t,e){try{return t[e]}catch(t){}},Tn=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=Ln(e=Object(t),jn))?n:Pn?vt(e):"Object"==(r=vt(e))&&"function"==typeof e.callee?"Arguments":r},Mn=It("iterator"),Nn=B.getIteratorMethod=function(t){if(void 0!=t)return t[Mn]||t["@@iterator"]||dt[Tn(t)]},Fn=It("iterator"),Cn=!1;try{var Rn=[7][Fn]();Rn.return=function(){Cn=!0},Array.from(Rn,function(){throw 2})}catch(t){}var zn=function(t,e){if(!e&&!Cn)return!1;var n=!1;try{var r=[7],i=r[Fn]();i.next=function(){return{done:n=!0}},r[Fn]=function(){return i},t(r)}catch(t){}return n};et(et.S+et.F*!zn(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,i,o=Kt(t),u="function"==typeof this?this:Array,a=arguments.length,c=a>1?arguments[1]:void 0,s=void 0!==c,f=0,l=Nn(o);if(s&&(c=H(c,a>2?arguments[2]:void 0,2)),void 0==l||u==Array&&xn(l))for(n=new u(e=wt(o.length));e>f;f++)Sn(n,f,s?c(o[f],f):o[f]);else for(i=l.call(o),n=new u;!(r=i.next()).done;f++)Sn(n,f,s?kn(i,c,[r.value,f],!0):r.value);return n.length=f,n}});var Bn,Dn,Hn,In=B.Array.from,Gn=e(function(t){t.exports={default:In,__esModule:!0}}),Wn=t(Gn),qn=(t(e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(Gn);e.default=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return(0,n.default)(t)}})),function(t){function e(n,i,u){if(r(n)||o(n)){i=i||(o(n)?{}:[]);for(var a in n)i[a]=e(n[a],i[a],a);return i}return t(n,i,u)}return e}(function(t){return t})),$n=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t},Un=e(function(t){var e={},n={},r=t.exports=function(t,r,i,o,u){var a,c,s,f,l=u?function(){return t}:Nn(t),h=H(i,o,r?2:1),d=0;if("function"!=typeof l)throw TypeError(t+" is not iterable!");if(xn(l)){for(a=wt(t.length);a>d;d++)if((f=r?h(G(c=t[d])[0],c[1]):h(t[d]))===e||f===n)return f}else for(s=l.call(t);!(c=s.next()).done;)if((f=kn(s,h,c.value,r))===e||f===n)return f};r.BREAK=e,r.RETURN=n}),Kn=It("species"),Jn=function(t,e){var n,r=G(t).constructor;return void 0===r||void 0==(n=G(r)[Kn])?e:D(n)},Vn=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},Yn=z.process,Xn=z.setImmediate,Qn=z.clearImmediate,Zn=z.MessageChannel,tr=0,er={},nr=function(){var t=+this;if(er.hasOwnProperty(t)){var e=er[t];delete er[t],e()}},rr=function(t){nr.call(t.data)};Xn&&Qn||(Xn=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return er[++tr]=function(){Vn("function"==typeof t?t:Function(t),e)},Bn(tr),tr},Qn=function(t){delete er[t]},"process"==vt(Yn)?Bn=function(t){Yn.nextTick(H(nr,t,1))}:Zn?(Hn=(Dn=new Zn).port2,Dn.port1.onmessage=rr,Bn=H(Hn.postMessage,Hn,1)):z.addEventListener&&"function"==typeof postMessage&&!z.importScripts?(Bn=function(t){z.postMessage(t+"","*")},z.addEventListener("message",rr,!1)):Bn="onreadystatechange"in K("script")?function(t){Rt.appendChild(K("script")).onreadystatechange=function(){Rt.removeChild(this),nr.call(t)}}:function(t){setTimeout(H(nr,t,1),0)});var ir,or,ur,ar={set:Xn,clear:Qn},cr=ar.set,sr=z.MutationObserver||z.WebKitMutationObserver,fr=z.process,lr=z.Promise,hr="process"==vt(fr),dr=It("species"),pr=ar.set,vr=function(){var t,e,n,r=function(){var r,i;for(hr&&(r=fr.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(hr)n=function(){fr.nextTick(r)};else if(sr){var i=!0,o=document.createTextNode("");new sr(r).observe(o,{characterData:!0}),n=function(){o.data=i=!i}}else if(lr&&lr.resolve){var u=lr.resolve();n=function(){u.then(r)}}else n=function(){cr.call(z,r)};return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}(),yr=z.TypeError,mr=z.process,gr=z.Promise,mr=z.process,wr="process"==Tn(mr),_r=function(){},br=!!function(){try{var t=gr.resolve(1),e=(t.constructor={})[It("species")]=function(t){t(_r,_r)};return(wr||"function"==typeof PromiseRejectionEvent)&&t.then(_r)instanceof e}catch(t){}}(),Er=function(t,e){return t===e||t===gr&&e===ur},kr=function(t){var e;return!(!I(t)||"function"!=typeof(e=t.then))&&e},Or=function(t){return Er(gr,t)?new Ar(t):new or(t)},Ar=or=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw yr("Bad Promise constructor");e=t,n=r}),this.resolve=D(e),this.reject=D(n)},xr=function(t){try{t()}catch(t){return{error:t}}},Sr=function(t,e){if(!t._n){t._n=!0;var n=t._c;vr(function(){for(var r=t._v,i=1==t._s,o=0;n.length>o;)!function(e){var n,o,u=i?e.ok:e.fail,a=e.resolve,c=e.reject,s=e.domain;try{u?(i||(2==t._h&&Lr(t),t._h=1),!0===u?n=r:(s&&s.enter(),n=u(r),s&&s.exit()),n===e.promise?c(yr("Promise-chain cycle")):(o=kr(n))?o.call(n,a,c):a(n)):c(r)}catch(t){c(t)}}(n[o++]);t._c=[],t._n=!1,e&&!t._h&&jr(t)})}},jr=function(t){pr.call(z,function(){var e,n,r,i=t._v;if(Pr(t)&&(e=xr(function(){wr?mr.emit("unhandledRejection",i,t):(n=z.onunhandledrejection)?n({promise:t,reason:i}):(r=z.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=wr||Pr(t)?2:1),t._a=void 0,e)throw e.error})},Pr=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,r=0;n.length>r;)if((e=n[r++]).fail||!Pr(e.promise))return!1;return!0},Lr=function(t){pr.call(z,function(){var e;wr?mr.emit("rejectionHandled",t):(e=z.onrejectionhandled)&&e({promise:t,reason:t._v})})},Tr=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Sr(e,!0))},Mr=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw yr("Promise can't be resolved itself");(e=kr(t))?vr(function(){var r={_w:n,_d:!1};try{e.call(t,H(Mr,r,1),H(Tr,r,1))}catch(t){Tr.call(r,t)}}):(n._v=t,n._s=1,Sr(n,!1))}catch(t){Tr.call({_w:n,_d:!1},t)}}};br||(gr=function(t){$n(this,gr,"Promise","_h"),D(t),ir.call(this);try{t(H(Mr,this,1),H(Tr,this,1))}catch(t){Tr.call(this,t)}},(ir=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:Z(t,r,e[r]);return t}(gr.prototype,{then:function(t,e){var n=Or(Jn(this,gr));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=wr?mr.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Sr(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Ar=function(){var t=new ir;this.promise=t,this.resolve=H(Mr,t,1),this.reject=H(Tr,t,1)}),et(et.G+et.W+et.F*!br,{Promise:gr}),qt(gr,"Promise"),function(t){var e="function"==typeof B[t]?B[t]:z[t];q&&e&&!e[dr]&&X.f(e,dr,{configurable:!0,get:function(){return this}})}("Promise"),ur=B.Promise,et(et.S+et.F*!br,"Promise",{reject:function(t){var e=Or(this);return(0,e.reject)(t),e.promise}}),et(et.S+!0*et.F,"Promise",{resolve:function(t){if(t instanceof gr&&Er(t.constructor,this))return t;var e=Or(this);return(0,e.resolve)(t),e.promise}}),et(et.S+et.F*!(br&&zn(function(t){gr.all(t).catch(_r)})),"Promise",{all:function(t){var e=this,n=Or(e),r=n.resolve,i=n.reject,o=xr(function(){var n=[],o=0,u=1;Un(t,!1,function(t){var a=o++,c=!1;n.push(void 0),u++,e.resolve(t).then(function(t){c||(c=!0,n[a]=t,--u||r(n))},i)}),--u||r(n)});return o&&i(o.error),n.promise},race:function(t){var e=this,n=Or(e),r=n.reject,i=xr(function(){Un(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i&&r(i.error),n.promise}});var Nr=B.Promise,Fr=(e(function(t){t.exports={default:Nr,__esModule:!0}}),"undefined"!=typeof window&&Object.prototype.toString.call(window),window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return setTimeout(t,17)}),Cr=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||function(t){clearTimeout(t)},Rr=Object.assign,zr=!Rr||W(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=Rr({},t)[n]||Object.keys(Rr({},e)).join("")!=r})?function(t,e){for(var n=Kt(t),r=arguments.length,i=1,o=me.f,u=ge.f;r>i;)for(var a,c=yt(arguments[i++]),s=o?Ft(c).concat(o(c)):Ft(c),f=s.length,l=0;f>l;)u.call(c,a=s[l++])&&(n[a]=c[a]);return n}:Rr;et(et.S+et.F,"Object",{assign:zr});var Br=B.Object.assign,Dr=t(e(function(t){t.exports={default:Br,__esModule:!0}}));et(et.S,"Object",{create:Ht});var Hr=B.Object,Ir=function(t,e){return Hr.create(t,e)},Gr=t(e(function(t){t.exports={default:Ir,__esModule:!0}})),Wr=Gr(null);Wr.count=0;!function(){function t(e,n){var r=this;if(R(this,t),Object.defineProperty(this,"__target",{writable:!0,enumerable:!1,configurable:!0}),this.__target=this,e){if("object"!==(void 0===e?"undefined":an(e)))throw new Error("CusEvent target are not object");this.__target=e,n&&["on","once","off","emit"].forEach(function(t){e[t]=r[t]})}}ot(t,[{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return p(this.__target,t,e,n),this}},{key:"once",value:function(t,e){return this.on(t,e,!0)}},{key:"off",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return v(this.__target,t,e,n),this}},{key:"emit",value:function(t,e){return d(this.__target,t,{data:e}),this}}])}();var qr=Gr(null);qr.count=0;(function(){function t(e,n){var r=this;if(R(this,t),Object.defineProperty(this,"__target",{writable:!0,enumerable:!1,configurable:!0}),this.__target=this,e){if("object"!==(void 0===e?"undefined":an(e)))throw new Error("CusEvent target are not object");this.__target=e,n&&["on","once","off","emit"].forEach(function(t){e[t]=r[t]})}}ot(t,[{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return g(this.__target,t,e,n),this}},{key:"once",value:function(t,e){return this.on(t,e,!0)}},{key:"off",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return w(this.__target,t,e,n),this}},{key:"emit",value:function(t,e){return m(this.__target,t,{data:e}),this}}])})(),"undefined"!=typeof window&&Object.prototype.toString.call(window);var $r=document.createElement("div"),Ur="innerText";"textContent"in $r&&(Ur="textContent");var Kr=Array.prototype,Jr=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;R(this,t);var i=this;i.selector=e;var o=void 0;e&&e.constructor===NodeList?o=_(e):r(e)?o=e:a(e)?0===e.indexOf("<")?($r.innerHTML=e,o=M("*",$r,!0)):o=M(e,n,!0):o=[e],Dr(i,o),i.length=o.length}return ot(t,[{key:"each",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Kr.forEach.apply(this,e),this}},{key:"push",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return Kr.push.apply(this,e),this}},{key:"splice",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return C(Kr.splice.apply(this,e))}},{key:"find",value:function(t){var e=[];this.each(function(n){e=e.concat(M(t,n,!0))});var n=C(e);return n.parent=this,n.selector=t,n}},{key:"append",value:function(t){var e=C(t),n=this[0];return e.each(function(t){return n.appendChild(t)}),this}},{key:"appendTo",value:function(t){return C(t).append(this),this}},{key:"text",value:function(t){return 0===arguments.length?this[0][Ur]:this.each(function(e){e[Ur]=t})}},{key:"html",value:function(t){return 0===arguments.length?this[0].innerHTML:this.each(function(e){e.innerHTML=t})}},{key:"attr",value:function(t,e){return 1===arguments.length?b(this[0],t):this.each(function(n){return E(n,t,e)})}},{key:"data",value:function(t,e){return 0===arguments.length?this[0].dataset||{}:1===arguments.length?(this[0].dataset||{})[t]:this.each(function(n){(n.dataset||(n.dataset={}))[t]=e})}},{key:"css",value:function(t,e){return 1!==arguments.length||o(t)?this.each(function(n){return T(n,t,e)}):L(this[0],t)}},{key:"addClass",value:function(t){return this.each(function(e){return k(e,t)})}},{key:"removeClass",value:function(t){return this.each(function(e){return O(e,t)})}},{key:"hasClass",value:function(t){return A(this[0],t)}},{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return S(i,t,e,n,r)})}},{key:"off",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return x(i,t,e,n,r)})}},{key:"delegate",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return j(i,t,e,n,r)})}},{key:"undelegate",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.each(function(i){return P(i,t,e,n,r)})}},{key:"remove",value:function(){return this.each(function(t){return N(t)})}}]),t}(),Vr=function(){function t(e,n,r){R(this,t),this.create(e),this.thread=n,this.timer=null,this.pDom=e,this.fontSize=r.fontSize,this.lineHeight=r.lineHeight}return ot(t,[{key:"create",value:function(t){var e=document.createElement("canvas");t.appendChild(e),this.layer=e,this.width=this.layer.width=t.offsetWidth,this.height=this.layer.height=t.offsetHeight,this.context=this.layer.getContext("2d")}},{key:"destroy",value:function(){Cr.call(window,this.timer),this.layer.parentNode.removeChild(this.layer)}},{key:"createPiece",value:function(t){var e=document.createElement("canvas"),n=e.getContext("2d"),r="small"===t.fontSize?.6:1,i=Math.floor(r*this.fontSize)+"px",o=t.fontFamily||"serif";return n.font=i+" "+o,e.width=n.measureText(t.text).width,e.height=this.lineHeight,n.font=i+" "+o,n.textAlign="left",n.textBaseline="top",n.fillStyle=t.color||"#ffffff",n.fillText(t.text,0,0),e}},{key:"start",value:function(){this.render()}},{key:"pause",value:function(){Cr.call(window,this.timer)}},{key:"draw",value:function(t){this.context.drawImage(t.piece,t.offset.x,t.offset.y,t.piece.width,t.piece.height)}},{key:"resize",value:function(){this.width=this.layer.width=this.pDom.offsetWidth,this.height=this.layer.height=this.pDom.offsetHeight,this.render(),this.pause()}},{key:"render",value:function(){var t=this;this.clear(),this.thread.pool.forEach(function(e,n){if(t.draw(e),"flow"===e.mode)e.offset.x-=e.speed,e.offset.x<-e.piece.width&&t.thread.remove(n);else{var r=new Date,i=e.row;e.startTime=e.startTime||new Date,r-e.startTime>5e3&&(t.thread.remove(n),t.thread.vRows[i].shift())}}),this.timer=Fr.call(window,function(){t.render()})}},{key:"clear",value:function(){this.context.clearRect(0,0,this.layer.width,this.layer.height)}}]),t}(),Yr=function(){function t(e,n){R(this,t),this.pool=[],this.pDom=e,this.config=n,this.resize()}return ot(t,[{key:"resize",value:function(){this.rows=Math.floor(parseInt(this.pDom.offsetHeight)/this.config.lineHeight),this.vRows=Dr(new Array(this.rows),this.vRows)}},{key:"get",value:function(t){return this.pool[t]}},{key:"push",value:function(t){this.pool.push(t)}},{key:"remove",value:function(t){this.pool.splice(t,1)}},{key:"empty",value:function(){this.pool=[],this.vRows=new Array(this.rows)}}]),t}(),Xr=function(){function t(e,n,r){R(this,t),this.create(e),this.thread=n,this.timer=null,this.pDom=e,this.fontSize=r.fontSize,this.lineHeight=r.lineHeight}return ot(t,[{key:"create",value:function(t){var e=document.createElement("div");t.appendChild(e),this.layer=e,this.width=t.offsetWidth,this.height=t.offsetHeight}},{key:"destroy",value:function(){Cr.call(window,this.timer),this.layer.parentNode.removeChild(this.layer)}},{key:"createPiece",value:function(t){var e="small"===t.fontSize?.6:1,n=Math.floor(e*this.fontSize)+"px",r=t.fontFamily||"serif",i=t.color||"#ffffff",o=document.createElement("div");return o.className="danmu-piece",T(o,{color:i,fontSize:n,fontFamily:r,transform:"translateX(-9999px)"}),o.textContent=t.text,this.layer.appendChild(o),o.width=o.offsetWidth,o.height=this.lineHeight,o}},{key:"start",value:function(){this.render()}},{key:"pause",value:function(){Cr.call(window,this.timer)}},{key:"resize",value:function(){this.width=this.pDom.offsetWidth,this.height=this.pDom.offsetHeight}},{key:"render",value:function(){var t=this;this.thread.pool.forEach(function(e,n){if(T(e.piece,"transform","translateX("+e.offset.x+"px) translateY("+e.offset.y+"px) "),"flow"===e.mode)e.offset.x-=e.speed,e.offset.x<-e.piece.width&&(e.piece.parentNode.removeChild(e.piece),t.thread.remove(n));else{var r=new Date,i=e.row;e.startTime=e.startTime||new Date,r-e.startTime>5e3&&(e.piece.parentNode.removeChild(e.piece),t.thread.remove(n),t.thread.vRows[i].shift())}}),this.timer=Fr.call(window,function(){t.render()})}},{key:"clear",value:function(){this.layer.innerHTML=""}}]),t}(),Qr=function(){function t(e,n){R(this,t),this.plugin=e,this.pDom=e.$dom,this.config=n,this.thread=new Yr(e.$dom,n),this.changeMode(n.mode),this.lineHeight=n.lineHeight,this.timer=null}return ot(t,[{key:"start",value:function(){this.paper.start()}},{key:"pause",value:function(){this.paper.pause()}},{key:"clear",value:function(){this.thread.empty(),this.paper&&this.paper.clear()}},{key:"destroy",value:function(){this.paper.destroy()}},{key:"resize",value:function(){this.paper.resize(),this.thread.resize()}},{key:"changeMode",value:function(t){t!==this.mode&&(this.clear(),this.paper&&this.destroy(),this.paper="css"===t?new Xr(this.pDom,this.thread,this.config):new Vr(this.pDom,this.thread,this.config),!this.plugin.paused&&this.paper.start(),this.mode=t)}},{key:"_line",value:function(t){for(var e=this.thread.pool,n=e.length,r=new Array(this.thread.rows),i=0,o=n-1;o>=0;o--)if("flow"===e[o].mode){var u=e[o].row;r[u]=r[u]?r[u]:e[o]}for(var a=0,c=0;c<r.length;c++){if(!r[c]){i=c;break}var s=r[c].offset.x+r[c].piece.width;if(t.width<this.paper.width-s){i=c;break}(!a||s<a)&&(a=s,i=r[c].row)}return i}},{key:"_vLine",value:function(t){var e=this.thread.vRows,n=e.length,r=0;return r=e.every(function(t,n){return Array.isArray(e[0])&&t.length===e[0].length})?"top"===t.mode?0:n-1:this._cLine(e,t),e[r]=e[r]?e[r].concat(t):[t],r}},{key:"_cLine",value:function(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=0===i?n-1:i-1,u=i===n-1?0:i+1,a=Array.isArray(t[o])?t[o].length:0,c=Array.isArray(t[u])?t[u].length:0,s=Array.isArray(t[i])?t[i].length:0;(!s||s<a||s<c)&&r.push(i)}return"top"===e.node?r[0]:r[r.length-1]}},{key:"emit",value:function(t){if("close"!==this.status){var e={};"string"==typeof t?e.text=t:e=t,(t=l({text:"你真的很漂亮",mode:"flow",fontSize:"big",color:"#fff"},e)).mode=t.mode||"flow";var n=this.paper.createPiece(t),r="flow"===t.mode?this._line(n):this._vLine(t);this.thread.pool.push({piece:n,text:t.text,mode:t.mode,speed:.3*Math.pow(n.width,1/3),row:r,offset:{x:"flow"===t.mode?this.paper.width:(this.paper.width-n.width)/2,y:this.lineHeight*r}})}}}]),t}();!function(t,e){if("undefined"==typeof document)return e;t=t||"";var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}("chimee-danmu{position:absolute;top:0;left:0;display:block;width:100%;height:100%}chimee-danmu>div{width:100%;height:100%;user-select:none}chimee-danmu .danmu-piece{position:absolute;left:0;top:0;display:inline-block;white-space:pre;pointer-events:none;font-weight:400;line-height:1.125;opacity:1;text-shadow:#000 1px 0 1px,#000 0 1px 1px,#000 0 -1px 1px,#000 -1px 0 1px}",void 0);var Zr={lineHeight:30,fontSize:24,mode:"css"},ti={name:"chimeeDanmu",el:"chimee-danmu",data:{status:"open",danmu:{},danmuList:[],currentPostion:0,currentPiece:{}},operable:!0,penetrate:!0,level:-1,create:function(){},init:function(t){if(!t||!1!==t.danmu){var e=o(this.$config)?l(Zr,this.$config):Zr;this.danmu=new Qr(this,e),S(window,"resize",this._resize)}},inited:function(){},destroy:function(){this.danmu.destroy(),this.$dom.parentNode.removeChild(this.$dom),x(window,"resize",this._resize)},events:{play:function(){"open"===this.status&&this.danmu.start()},pause:function(){"open"===this.status&&this.danmu.pause()},timeupdate:function(){if("close"!==this.status)for((Math.abs(this.currentTime-this.currentPiece.time)>1||void 0===this.currentPiece.time)&&this.__searchPosition();this.currentTime>=this.currentPiece.time&&this.currentPiece.time;)this.danmu.emit(this.currentPiece),this.currentPiece=this.danmuList[this.currentPostion++]||{}},contextmenu:function(){}},methods:{__searchPosition:function(){var t=this.danmuList.length;if(0!==t){if(this.currentTime>this.danmuList[t-1].time)return this.currentPiece={},void(this.currentPostion=t+1);if(this.currentTime<this.danmuList[0].time)return this.currentPiece=this.danmuList[0],void(this.currentPostion=0);for(var e=0;e<t;e++){var n=this.danmuList[e];if(n.time>=this.currentTime){this.currentPostion=e,this.currentPiece=n;break}}}},open:function(){this.status="open"},close:function(){this.status="close",this.danmu.clear(),this.danmu.pause()},start:function(){this.danmu.start()},pause:function(){this.danmu.pause()},changeMode:function(t){this.danmu.changeMode(t)},sendMsg:function(t){"open"===this.status&&this.danmu.emit(t)},receiveData:function(t){this.danmuList=t,this.currentPiece=this.danmuList[this.currentPostion++]||{}},_resize:function(){this.danmu.resize()}}};module.exports=ti});
